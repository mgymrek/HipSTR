<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Hipstr by tfwillems</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">Hipstr</h1>
        <p class="header">Genotype, phase and impute short tandem repeats using whole-genome sequencing data</p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/tfwillems/HipSTR/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/tfwillems/HipSTR/tarball/master">Download TAR</a></li>
          <li><a class="buttons github" href="https://github.com/tfwillems/HipSTR">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/tfwillems">tfwillems</a></p>


      </header>
      <section>
        <h1>
<a id="hipstr-" class="anchor" href="#hipstr-" aria-hidden="true"><span class="octicon octicon-link"></span></a>HipSTR <a href="https://travis-ci.org/tfwillems/HipSTR"><img src="https://travis-ci.org/tfwillems/HipSTR.svg?branch=master" alt="Build Status"></a>
</h1>

<p><strong>H</strong>aplotype-based <strong>i</strong>mputation, <strong>p</strong>hasing and genotyping of <strong>STR</strong>s</p>

<h4>
<a id="author-thomas-willems-twillemsmitedu" class="anchor" href="#author-thomas-willems-twillemsmitedu" aria-hidden="true"><span class="octicon octicon-link"></span></a>Author: Thomas Willems <a href="mailto:twillems@mit.edu">twillems@mit.edu</a>
</h4>

<h4>
<a id="license-gnu-v2" class="anchor" href="#license-gnu-v2" aria-hidden="true"><span class="octicon octicon-link"></span></a>License: GNU v2</h4>

<h2>
<a id="introduction" class="anchor" href="#introduction" aria-hidden="true"><span class="octicon octicon-link"></span></a>Introduction</h2>

<p>Short tandem repeats <a href="http://en.wikipedia.org/wiki/Microsatellite">(STRs)</a> are highly repetitive genomic sequences comprised of repeated copies of an underlying motif. Prevalent in most organisms' genomes, STRs are of particular interest because they mutate much more rapidly than most other genomic elements. As a result, they're extremely informative for genomic identification, ancestry inference and genealogy.</p>

<p>Despite their utility, STRs are particularly difficult to genotype. The repetitive sequence responsible for their high mutability also results in frequent alignment errors that can complicate and bias downstream analyses. In addition, PCR stutter errors often result in reads that contain additional or fewer repeat copies than the true underlying genotype. </p>

<p><strong>HipSTR</strong> was specifically developed to deal with these errors in the hopes of obtaining more robust STR genotypes. In particular, it accomplishes this by:</p>

<ol>
<li>Learning locus-specific PCR stutter models using an <a href="http://en.wikipedia.org/wiki/Expectation%E2%80%93maximization_algorithm">EM algorithm</a>
</li>
<li>Mining candidate STR alleles from population-scale sequencing data</li>
<li>Utilizing phased SNP haplotypes to genotype, phase and/or impute STRs</li>
<li>Employing a specialized hidden Markov model to align reads to candidate sequences while accounting for stutter</li>
</ol>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation</h2>

<p>HipSTR requires a standard c++ compiler, <a href="http://www.cmake.org/download/">CMake</a> as well as Java version 1.7 or later.
To obtain HipSTR and all of its associated submodules, use:</p>

<pre><code>% git clone --recursive https://github.com/tfwillems/HipSTR.git
</code></pre>

<p>To build, use Make:</p>

<pre><code>% cd HipSTR
% make
</code></pre>

<p>On Mac, before running Make, change the line in <em>vcflib/smithwaterman/Makefile</em> from <code>LDFLAGS=-Wl,-s</code> to <code>LDFLAGS=-Wl</code></p>

<h2>
<a id="quick-start" class="anchor" href="#quick-start" aria-hidden="true"><span class="octicon octicon-link"></span></a>Quick Start</h2>

<p>To run HipSTR in its most broadly applicable mode, run it on <strong>all samples concurrently</strong> using the syntax:</p>

<pre><code>./HipSTR --bams          run1.bam,run2.bam,run3.bam,run4.bam
         --fasta         /data/
         --regions       str_regions.bed
         --stutter-out   stutter_models.txt
         --str-vcf       str_calls.vcf.gz
</code></pre>

<ul>
<li>
<strong>--bam</strong> :  a comma-separated list of <a href="#bams">BAM</a> files generated by any indel-sensitive aligner (e.g. <a href="http://lobstr.teamerlich.org/index.html">lobSTR</a> or <a href="http://bio-bwa.sourceforge.net/bwa.shtml">BWA-MEM</a>) and sorted and indexed using samtools</li>
<li>
<strong>--regions</strong> : a <a href="#str-bed">BED</a> file containing the coordinates for each STR region of interest</li>
<li>
<strong>--fasta</strong> : the directory containing <a href="https://en.wikipedia.org/wiki/FASTA_format">FASTA files</a> for each chromosome in the BED file. In the above usage example, if <em>str_regions.bed</em> contains chr1, chr2, and chr10, the corresponding files would be <em>/data/chr1.fa</em>, <em>/data/chr2.fa</em> and <em>/data/chr10.fa</em>. Alternatively, you can supply the path for a single FASTA file containing all of the relevant sequences</li>
</ul>

<p>For each region in <em>str_regions.bed</em>, <strong>HipSTR</strong> will:</p>

<ol>
<li>Learn locus-specific stutter models and output them to <em>stutter_models.txt</em>
</li>
<li>Use the stutter model and haplotype-based alignment algorithm to genotype each individual</li>
<li>Output the resulting STR genotypes to <em>str_calls.vcf.gz</em>, a <a href="http://www.htslib.org/doc/tabix.html">bgzipped</a> <a href="#str-vcf">VCF</a> file. This VCF will contain calls for each sample in any of the BAM files' read groups. </li>
</ol>

<h2>
<a id="in-depth-usage" class="anchor" href="#in-depth-usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>In-depth usage</h2>

<p><strong>HipSTR</strong> has a variety of usage options designed to accomodate scenarios in which the sequencing data varies in terms of the number of samples and the coverage. Most scenarios will fall into one of the following categories:</p>

<ol>
<li>200 or more low-coverage (~5x) samples

<ul>
<li>Sufficient reads for stutter estimation</li>
<li>Sufficient reads to detect candidate STR alleles</li>
<li><a href="#mode-1"><strong>Use de novo stutter estimation + STR calling with de novo allele generation</strong></a></li>
</ul>
</li>
<li>50 or more high-coverage (~30x) samples

<ul>
<li>Sufficient reads for stutter estimation</li>
<li>Sufficient reads to detect candidate STR alleles</li>
<li><a href="#mode-1"><strong>Use de novo stutter estimation + STR calling with de novo allele generation</strong></a></li>
</ul>
</li>
<li>Handful of low-coverage  (~5x) samples

<ul>
<li>Insufficient reads for stutter estimation</li>
<li>Insufficient reads to detect candidate STR alleles</li>
<li><a href="#mode-3"><strong>Use external stutter models + STR calling with a reference panel</strong></a></li>
</ul>
</li>
<li>Handful of high-coverage (~30x) samples

<ul>
<li>Insufficient samples for stutter estimation</li>
<li>Sufficient reads to detect candidate STR alleles</li>
<li><a href="#mode-2"><strong>Use external stutter models + STR calling with de novo allele generation</strong></a></li>
</ul>
</li>
</ol>

<p><a id="mode-1"></a></p>

<h4>
<a id="1-de-novo-stutter-estimation--str-calling-with-de-novo-allele-generation" class="anchor" href="#1-de-novo-stutter-estimation--str-calling-with-de-novo-allele-generation" aria-hidden="true"><span class="octicon octicon-link"></span></a>1. De novo stutter estimation + STR calling with de novo allele generation</h4>

<p>This mode is identical to the one suggested in the <strong>Quick Start</strong> section as it suits most applications. HipSTR will output the learned stutter models to <em>stutter_models.txt</em> and the STR genotypes in bgzipped VCF format to <em>str_calls.vcf.gz</em> </p>

<pre><code>./HipSTR --bams             run1.bam,run2.bam,run3.bam,run4.bam
         --fasta            /data/
         --regions          str_regions.bed
         --stutter-out      stutter_models.txt
         --str-vcf          str_calls.vcf.gz
</code></pre>

<p><a id="mode-2"></a></p>

<h4>
<a id="2-external-stutter-models--str-calling-with-de-novo-allele-generation" class="anchor" href="#2-external-stutter-models--str-calling-with-de-novo-allele-generation" aria-hidden="true"><span class="octicon octicon-link"></span></a>2. External stutter models + STR calling with de novo allele generation</h4>

<p>The sole difference in this mode is that we no longer output stutter models using the <strong>--stutter-out</strong> option and instead input them from a file using the <strong>--stutter-in</strong> file. For more details on the stutter model file format, see <a href="#stutter-file">below</a>. For humans, we've provided a file containing stutter models for each STR locus under PCR or PCR-free conditions at <a href="www.google.com">FILL ME IN</a></p>

<pre><code>./HipSTR --bams             run1.bam,run2.bam,run3.bam,run4.bam
         --fasta            /data/
         --regions          str_regions.bed
         --stutter-in       ext_stutter_models.txt
         --str-vcf          str_calls.vcf.gz
</code></pre>

<p><a id="mode-3"></a></p>

<h4>
<a id="3-external-stutter-models--str-calling-with-a-reference-panel" class="anchor" href="#3-external-stutter-models--str-calling-with-a-reference-panel" aria-hidden="true"><span class="octicon octicon-link"></span></a>3. External stutter models + STR calling with a reference panel</h4>

<p>This mode is very similar to mode #2, except that we provide an additional VCF file containing known STR genotypes at each locus using the <strong>--str-vcf</strong> option. <strong>HipSTR</strong> will not identify any additional candidate STR alleles in the BAMs when this option is specified, so it's best to use a VCF that contains STR genotypes for a wide range of populations and individuals. For humans, we've provided such a file based on the <a href="http://www.1000genomes.org/">1000 Genomes Project</a> at <a href="www.google.com">FILL ME IN</a></p>

<pre><code>./HipSTR --bams             run1.bam,run2.bam,run3.bam,run4.bam
         --fasta            /data/
         --regions          str_regions.bed
         --stutter-in       ext_stutter_models.txt
         --ref-vcf          ref_strs.vcf.gz
         --str-vcf          str_calls.vcf.gz
</code></pre>

<h3>
<a id="str-imputation" class="anchor" href="#str-imputation" aria-hidden="true"><span class="octicon octicon-link"></span></a>STR imputation</h3>

<h2>
<a id="speed" class="anchor" href="#speed" aria-hidden="true"><span class="octicon octicon-link"></span></a>Speed</h2>

<p>HipSTR doesn't currently have multi-threaded support, but there are several options available to accelerate analyses:</p>

<ol>
<li>Analyze each chromosome in parallel using the <strong>--chrom</strong> option. For example, <strong>--chrom chr2</strong> will only genotype the BED regions on chr2</li>
<li>Utilize the length-based genotyper instead of the sequence-based genotyper using the <strong>--len-genotyper</strong> flag. This will vastly accelerate analyses, but it only considers the sizes of indels in reads independently. As a result, it is incapable of determining the exact sequence of an STR and is susceptible to alignment errors</li>
<li>If you have hundreds of BAM files, we recommend that you merge them into a more manageable number (10-100) using the <code>samtools merge</code> command. Large numbers of BAMs can lead to slow disk IO and poor performance</li>
</ol>

<h2>
<a id="call-filtering" class="anchor" href="#call-filtering" aria-hidden="true"><span class="octicon octicon-link"></span></a>Call Filtering</h2>

<h2>
<a id="additional-usage-options" class="anchor" href="#additional-usage-options" aria-hidden="true"><span class="octicon octicon-link"></span></a>Additional Usage Options</h2>

<table>
<thead>
<tr>
<th align="left">Option</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><strong>--viz-out       </strong></td>
<td align="left">Output a bgzipped file containing Needleman-Wunsch alignments <br> for each locus. The resulting file can be readily visualized with <a href="#aln-viz">VizAln</a>
</td>
</tr>
<tr>
<td align="left"><strong>--haploid-chrs  </strong></td>
<td align="left">Comma separated list of chromosomes to treat as haploid <br> By default, all chromosomes are treated as diploid</td>
</tr>
<tr>
<td align="left"><strong>--no-rmdup</strong></td>
<td align="left">Don't remove PCR duplicates. By default, they'll be removed</td>
</tr>
<tr>
<td align="left"><strong>--snp-vcf    </strong></td>
<td align="left">Bgzipped VCF file containing phased SNP genotypes for samples <br> that are being genotyped. These SNPs will be used to physically <br> phase any STRs when a read or its mate pair overlaps a heterozygous site <br> <strong>Always use this option if you have available phased SNP genotypes</strong>
</td>
</tr>
<tr>
<td align="left"><strong>--bam-samps     </strong></td>
<td align="left">Comma separated list of samples in same order as BAM files. <br> Assign each read to the sample corresponding to its file. By default, <br> each read must have an RG flag and the associated sample is used instead</td>
</tr>
<tr>
<td align="left"><strong>--bam-lbs       </strong></td>
<td align="left">Comma separated list of libraries in same order as BAM files. <br> Assign each read to the library corresponding to its file. By default, <br> each read must have an RG flag and the associated library is used instead <br> NOTE: This option is required when --bam-samps has been specified</td>
</tr>
</tbody>
</table>

<p>This list is comprised of the most useful and frequently used additional options, but is not all encompassing. For a complete list of options, please type either <code>./HipSTR</code> or <code>./HipSTR --help</code></p>

<p><a id="aln-viz"></a></p>

<h2>
<a id="alignment-visualization" class="anchor" href="#alignment-visualization" aria-hidden="true"><span class="octicon octicon-link"></span></a>Alignment Visualization</h2>

<p>When deciphering and inspecting STR calls, it's extremely useful to visualize the supporting reads. HipSTR facilitates this through the <strong>--viz-out</strong> option, which writes a bgzipped file containing alignments for each call that can be readily visualized using the <strong>VizAln</strong> command included in HipSTR main directory. If you're interested in visualizing alignments, you first need to index the file using tabix. 
For example, if you ran HipSTR with the option <code>--viz-out aln.html.gz</code>, you should use the command</p>

<pre><code>tabix -p bed aln.html.gz
</code></pre>

<p>to generate a <a href="http://www.htslib.org/doc/tabix.html">tabix</a> index for the file so that we can rapidly extract alignments for a locus of interest. This command only needs to be run once after the file has been generated. </p>

<p>You could then visualize the calls for sample <em>ERR218433</em> at locus <em>chr1 51639636</em> using the command</p>

<pre><code>./VizAln aln.html.gz chr1 51639636 ERR218433
</code></pre>

<p>This command will automatically open a rendering of the alignments in your browser and might look something like:
<img src="https://github.com/tfwillems/HipSTR/blob/master/examples/example_viz.png" alt="Read more words!">
The top bar represents the reference sequence and the red text indicates the name of the sample and its associated call at the locus. The remaining rows indicate the alignment for each read used in genotyping. In this particular example, 7 reads have a <em>4bp deletion</em>, 9 reads have a <em>8bp deletion</em> and 1 read has a <em>12bp deletion</em>. The solitary <em>12bp deletion</em> is likely the result of PCR stutter and HipSTR therefore genotypes this sample as <em>-4 | -8</em></p>

<p>If we wanted to inspect all calls for the same locus, we could  use the command </p>

<pre><code>./VizAln aln.html.gz chr1 51639636
</code></pre>

<p>NOTE: Because the <strong>--viz-out</strong> file can become fairly large if you're genotyping thousands of loci or thousands of samples, in some scenarios it may be best to rerun HipSTR using this option on the subset of loci in which you're interested.</p>

<h2>
<a id="file-formats" class="anchor" href="#file-formats" aria-hidden="true"><span class="octicon octicon-link"></span></a>File Formats</h2>

<p><a id="bams"></a></p>

<h3>
<a id="bam-files" class="anchor" href="#bam-files" aria-hidden="true"><span class="octicon octicon-link"></span></a>BAM files</h3>

<p>HipSTR requires <a href="https://samtools.github.io/hts-specs/SAMv1.pdf">BAM</a> files produced by any indel-sensitive aligner. These files must have been sorted by position using the <code>samtools sort</code> command and then indexed using <code>samtools index</code>. To associate a read with its sample of interest, HipSTR uses read group information in the BAM header lines. These <em><a href="https://github.com/RG" class="user-mention">@RG</a></em> lines must contain an <em>ID</em> field, an <em>LB</em> field indicating the library and an <em>SM</em> field indicating the sample. For example, if a BAM contained the following header line </p>

<blockquote>
<p><a href="https://github.com/RG" class="user-mention">@RG</a>     ID:RUN1 LB:ERR12345        SM:SAMPLE789</p>
</blockquote>

<p>an alignment with the RG tag </p>

<blockquote>
<p>RG:Z:RUN1</p>
</blockquote>

<p>will be associated with sample <em>SAMPLE789</em> and library <em>ERR12345</em>. In this manner, HipSTR can analyze BAMs containing more than one sample and/or more than one library and can handle BAMs in which a single sample's reads are spread across multiple files. </p>

<p>Alternatively, if your BAM files lack <em>RG</em> information, you can use the <strong>--bam-samps</strong> and <strong>-bam-lbs</strong> flags to specify the sample and library associated with each BAM. In this setting, however, a BAM can only contain a single library and a single read group. For example, the command</p>

<pre><code>./HipSTR --bams             run1.bam,run2.bam,run3.bam,run4.bam
         --fasta            /data/
         --regions          str_regions.bed
         --stutter-out      stutter_models.txt
         --str-vcf          str_calls.vcf.gz
         --bam-samps        SAMPLE1,SAMPLE1,SAMPLE2,SAMPLE3
         --bam-lbs          LIB1,LIB2,LIB3,LIB4
</code></pre>

<p>essentially tells HipSTR to associate all the reads in the first two BAMS with <em>SAMPLE1</em>, all the reads in the third file with <em>SAMPLE2</em> and all the reads in the last BAM with <em>SAMPLE3</em>.</p>

<p><a id="str-bed"></a></p>

<h3>
<a id="str-region-bed-file" class="anchor" href="#str-region-bed-file" aria-hidden="true"><span class="octicon octicon-link"></span></a>STR region BED file</h3>

<p>The BED file containing each STR region of interest is a tab-delimited file comprised of 5 required columns and one optional column: </p>

<ol>
<li>The name of the chromosome on which the STR is located</li>
<li>The start position of the STR on its chromosome</li>
<li>The end position of the STR on its chromosome</li>
<li>The motif length (i.e. the number of bases in the repeat unit)</li>
<li>The number of copies of the repeat unit in the reference allele</li>
</ol>

<p>The 6th column is optional and contains the name of the STR locus, which will be written to the ID column in the VCF. 
Below is an example file which contains 5 STR loci </p>

<p><strong>NOTE: The table header is for descriptive purposes. The BED file should not have a header</strong></p>

<table>
<thead>
<tr>
<th>CHROM</th>
<th>START</th>
<th>END</th>
<th>MOTIF_LEN</th>
<th>NUM_COPIES</th>
<th>NAME</th>
</tr>
</thead>
<tbody>
<tr>
<td>chr1</td>
<td>13784267</td>
<td>13784306</td>
<td>4</td>
<td>10</td>
<td>GATA27E01</td>
</tr>
<tr>
<td>chr1</td>
<td>18789523</td>
<td>18789555</td>
<td>3</td>
<td>11</td>
<td>ATA008</td>
</tr>
<tr>
<td>chr2</td>
<td>32079410</td>
<td>32079469</td>
<td>4</td>
<td>15</td>
<td>AGAT117</td>
</tr>
<tr>
<td>chr17</td>
<td>38994441</td>
<td>38994492</td>
<td>4</td>
<td>12</td>
<td>GATA25A04</td>
</tr>
<tr>
<td>chr17</td>
<td>55299940</td>
<td>55299992</td>
<td>4</td>
<td>13</td>
<td>AAT245</td>
</tr>
</tbody>
</table>

<p>For humans, we've provided a <em>BED</em> file containing STR loci for hg19 at <a href="www.google.com">FILL ME IN</a></p>

<p>For other model organisms, we recommend that you </p>

<ol>
<li>Use <a href="https://tandem.bu.edu/trf/trf.html">Tandem Repeats Finder</a> or other tools to scan the reference genome for STRs</li>
<li>Reformat the resulting output to conform with the format outlined above</li>
</ol>

<p><a id="str-vcf"></a></p>

<h3>
<a id="vcf-file" class="anchor" href="#vcf-file" aria-hidden="true"><span class="octicon octicon-link"></span></a>VCF file</h3>

<p>For more information on the VCF file format, please see the <a href="http://samtools.github.io/hts-specs/VCFv4.2.pdf">VCF spec</a>. For filtering and parsing VCFs, we recommend the fantastic python package <a href="http://pyvcf.readthedocs.org/en/latest/">PyVCF</a></p>

<h4>
<a id="info-fields" class="anchor" href="#info-fields" aria-hidden="true"><span class="octicon octicon-link"></span></a>INFO fields</h4>

<p><em>INFO</em> fields contains statistics about each genotyped locus in the VCF. The INFO fields reported by HipSTR primarily describe the learned/supplied stutter model for the locus and its reference coordinates and sequence characteristics.</p>

<table>
<thead>
<tr>
<th>FIELD</th>
<th>DESCRIPTION</th>
</tr>
</thead>
<tbody>
<tr>
<td>INFRAME_PGEOM</td>
<td>Parameter for in-frame geometric step size distribution</td>
</tr>
<tr>
<td>INFRAME_UP</td>
<td>Probability that stutter causes an in-frame increase in obs. STR size</td>
</tr>
<tr>
<td>INFRAME_DOWN</td>
<td>Probability that stutter causes an in-frame decrease in obs. STR size</td>
</tr>
<tr>
<td>OUTFRAME_PGEOM</td>
<td>Parameter for out-of-frame geometric step size distribution</td>
</tr>
<tr>
<td>OUTFRAME_UP</td>
<td>Probability that stutter causes an out-of-frame increase in obs. STR size</td>
</tr>
<tr>
<td>OUTFRAME_DOWN</td>
<td>Probability that stutter causes an out-of-frame decrease in obs. STR size</td>
</tr>
<tr>
<td>BPDIFFS</td>
<td>Base pair difference of each alternate allele from the reference allele</td>
</tr>
<tr>
<td>START</td>
<td>Inclusive start coodinate for the repetitive portion of the reference allele</td>
</tr>
<tr>
<td>END</td>
<td>Inclusive end coordinate for the repetitive portion of the reference allele</td>
</tr>
<tr>
<td>PERIOD</td>
<td>Length of STR motif</td>
</tr>
<tr>
<td>REFAC</td>
<td>Reference allele count</td>
</tr>
<tr>
<td>AC</td>
<td>Alternate allele counts</td>
</tr>
<tr>
<td>NSKIP</td>
<td>Number of samples not genotyped due to various issues</td>
</tr>
<tr>
<td>NFILT</td>
<td>Number of samples that were originally genotyped but have since been filtered</td>
</tr>
<tr>
<td>DP</td>
<td>Total number of reads used to genotype all samples</td>
</tr>
<tr>
<td>DSNP</td>
<td>Total number of reads with SNP information</td>
</tr>
<tr>
<td>DFILT</td>
<td>Total number of reads filtered due to various reasons</td>
</tr>
<tr>
<td>DSTUTTER</td>
<td>Total number of reads with a stutter indel in the STR region</td>
</tr>
<tr>
<td>DFLANKINDEL</td>
<td>Total number of reads with an indel in the regions flanking the STR</td>
</tr>
</tbody>
</table>

<h4>
<a id="format-fields" class="anchor" href="#format-fields" aria-hidden="true"><span class="octicon octicon-link"></span></a>FORMAT fields</h4>

<p><em>FORMAT</em> fields contain information about the genotype for each sample at the locus. In addition to the most probable phased genotype (<em>GT</em>), HipSTR reports information about the posterior likelihood of this genotype (<em>PQ</em>) and its unphased analog (<em>Q</em>). HipSTR also reports the expected base pair difference from the reference for the genotype by marginalizing over all genotype probabilities (<em>BPDOSE</em>), a value that may be useful in association studies. </p>

<table>
<thead>
<tr>
<th>FIELD</th>
<th>DESCRIPTION</th>
</tr>
</thead>
<tbody>
<tr>
<td>GT</td>
<td>Genotype</td>
</tr>
<tr>
<td>GB</td>
<td>Base pair differences of genotype from reference</td>
</tr>
<tr>
<td>Q</td>
<td>Posterior probability of unphased genotype</td>
</tr>
<tr>
<td>PQ</td>
<td>Posterior probability of phased genotype</td>
</tr>
<tr>
<td>DP</td>
<td>Number of valid reads used for sample's genotype</td>
</tr>
<tr>
<td>DSNP</td>
<td>Number of reads with SNP phasing information</td>
</tr>
<tr>
<td>PDP</td>
<td>Fractional reads supporting each haploid genotype</td>
</tr>
<tr>
<td>BQ</td>
<td>Bootstrapped quality score</td>
</tr>
<tr>
<td>GLDIFF</td>
<td>Difference in likelihood between the reported and next best genotypes</td>
</tr>
<tr>
<td>DSNP</td>
<td>Total number of reads with SNP information</td>
</tr>
<tr>
<td>DFILT</td>
<td>Number of reads filtered due to various issues</td>
</tr>
<tr>
<td>DSTUTTER</td>
<td>Number of reads with a stutter indel in the STR region</td>
</tr>
<tr>
<td>DFLANKINDEL</td>
<td>Number of reads with an indel in the regions flanking the STR</td>
</tr>
<tr>
<td>BPDOSE</td>
<td>Posterior mean base pair difference from reference</td>
</tr>
<tr>
<td>ALLREADS</td>
<td>Base pair difference observed in each read's Needleman-Wunsch alignment</td>
</tr>
<tr>
<td>MALLREADS</td>
<td>Maximum likelihood bp diff in each read based on haplotype alignments</td>
</tr>
<tr>
<td>PALLREADS</td>
<td>Expected base pair diff in each read based on haplotype alignment probs</td>
</tr>
<tr>
<td>GL</td>
<td>log-10 genotype likelihoods</td>
</tr>
<tr>
<td>PL</td>
<td>Phred-scaled genotype likelihoods</td>
</tr>
</tbody>
</table>

<p><a id="stutter-file"></a></p>

<h3>
<a id="stutter-model" class="anchor" href="#stutter-model" aria-hidden="true"><span class="octicon octicon-link"></span></a>Stutter model</h3>

<p>To model PCR stutter artifacts, we assume that there are three types of stutter artifacts:</p>

<ol>
<li>
<strong>In-frame changes</strong>: Change the size of the STR in the read by multiples of the repeat unit. For instance, if the repeat motif is AGAT, in-frame changes could lead to differences of -8, -4, 4, 8, and so on. </li>
<li>
<strong>Out-of-frame changes</strong>: Change the size of the STR by non-multiples of the repeat unit. For instance, if the repeat motif is AGAT, out-of-frame changes could lead to differences of -3, -2, -1, 1, 2, 3 and so on. </li>
<li>
<strong>No stutter change</strong>: The size of the STR in the read is the same as the size of the underlying STR. </li>
</ol>

<p>Stutter model files contain the information necessary to model each of these artifacts in a <strong>tab-delimited BED-like</strong> format with exactly 9 columns. An example of such a file is as follows:</p>

<table>
<thead>
<tr>
<th>CHROM</th>
<th>START</th>
<th>END</th>
<th>IGEOM</th>
<th>IDOWN</th>
<th>IUP</th>
<th>OGEOM</th>
<th>ODOWN</th>
<th>OUP</th>
</tr>
</thead>
<tbody>
<tr>
<td>chr1</td>
<td>13784267</td>
<td>13784306</td>
<td>0.95</td>
<td>0.05</td>
<td>0.01</td>
<td>0.9</td>
<td>0.01</td>
<td>0.001</td>
</tr>
<tr>
<td>chr1</td>
<td>18789523</td>
<td>18789555</td>
<td>0.8</td>
<td>0.01</td>
<td>0.05</td>
<td>0.9</td>
<td>0.001</td>
<td>0.001</td>
</tr>
<tr>
<td>chr2</td>
<td>32079410</td>
<td>32079469</td>
<td>0.9</td>
<td>0.01</td>
<td>0.01</td>
<td>0.9</td>
<td>0.001</td>
<td>0.001</td>
</tr>
<tr>
<td>chr17</td>
<td>38994441</td>
<td>38994492</td>
<td>0.9</td>
<td>0.001</td>
<td>0.001</td>
<td>0.9</td>
<td>0.001</td>
<td>0.001</td>
</tr>
<tr>
<td>chr17</td>
<td>55299940</td>
<td>55299992</td>
<td>0.95</td>
<td>0.01</td>
<td>0.01</td>
<td>0.9</td>
<td>0.001</td>
<td>0.001</td>
</tr>
</tbody>
</table>

<p><strong>NOTE: The table header is for descriptive purposes. The stutter file should not have a header</strong></p>

<p>Each of the stutter parameters is defined as follows:</p>

<table>
<thead>
<tr>
<th>VARIABLE</th>
<th>DESCRIPTION</th>
</tr>
</thead>
<tbody>
<tr>
<td>IDOWN</td>
<td>Probability that in-frame changes decrease the size of the observed STR allele</td>
</tr>
<tr>
<td>IUP</td>
<td>Probability that in-frame changes increase the size of the observed STR allele</td>
</tr>
<tr>
<td>ODOWN</td>
<td>Probability that out-of-frame changes decrease the size of the observed STR allele</td>
</tr>
<tr>
<td>OUP</td>
<td>Probability that out-of-frame changes increase the size of the observed STR allele</td>
</tr>
<tr>
<td>IGEOM</td>
<td>Parameter governing geometric step size distribution for in-frame changes</td>
</tr>
<tr>
<td>OGEOM</td>
<td>Paramter  governing geometric step size distribution for out-of-frame changes</td>
</tr>
</tbody>
</table>
      </section>
      <footer>
        <p><small>Hosted on <a href="https://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		
  </body>
</html>
